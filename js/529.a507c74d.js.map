{"version":3,"file":"js/529.a507c74d.js","mappings":"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","sources":["webpack://crm-course/./src/views/RecordPage.vue","webpack://crm-course/./src/views/RecordPage.vue?001b"],"sourcesContent":["<template>\r\n  <div class=\"record\">\r\n    <div class=\"page-title\">\r\n      <h3>Новая запись</h3>\r\n    </div>\r\n\r\n    <form class=\"record_form\" v-if=\"!loading\" @submit.prevent=\"handleForm\">\r\n      <div class=\"form_header\">\r\n        <div class=\"radio\">\r\n          <strong>Тип записи:</strong>\r\n          <div class=\"radio_input\">\r\n            <label for=\"income\">Доход</label>\r\n            <input\r\n                v-model=\"type\"\r\n                name=\"type\"\r\n                type=\"radio\"\r\n                value=\"income\"\r\n                id=\"income\"\r\n            />\r\n          </div>\r\n          <div class=\"radio_input\">\r\n            <label for=\"outcome\">Расход</label>\r\n            <input\r\n              v-model=\"type\"\r\n                name=\"type\"\r\n                type=\"radio\"\r\n                value=\"outcome\"\r\n                id=\"outcome\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"select\" v-if=\"categories.length\">\r\n          <base-select\r\n          v-model=\"category\"\r\n          :options=\"categories\"\r\n          >Выберите категорию</base-select>\r\n        </div>\r\n        <p v-else>Категорий пока нет. <router-link to=\"/categories\">Создать</router-link></p>\r\n      </div>\r\n      <base-input\r\n      v-model.number = \"amount\"\r\n      :placehldr=\"'Введите сумму'\"\r\n      :class=\"{\r\n        'incorrect': v$.amount.$errors.length\r\n      }\"\r\n      >\r\n        Сумма\r\n      </base-input>\r\n\r\n      <base-input\r\n      v-model=\"description\"\r\n      :placehldr=\"'Введите описание'\"\r\n      :class=\"{\r\n        'incorrect': v$.description.$errors.length\r\n      }\"\r\n      >Описание</base-input>\r\n\r\n      <base-button v-if=\"category\">Создать <i class=\"fa-solid fa-check\"></i></base-button>\r\n      <p v-else class=\"handle_category\">Выберите категорию операции выше</p>\r\n    </form>\r\n    <div class=\"handler\" v-else>\r\n      <base-loader></base-loader>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport BaseButton from '@/components/UI/BaseButton.vue'\r\nimport useVuelidate from '@vuelidate/core'\r\nimport {required, minValue} from '@vuelidate/validators'\r\nexport default {\r\n  components: { BaseButton },\r\n  name: \"RecordPage\",\r\n  data() {\r\n    return {\r\n      v$: useVuelidate(),\r\n      amount: 1,\r\n      description: '',\r\n      category: '',\r\n      loading: true,\r\n      categories: [],\r\n      type: 'income'\r\n    }\r\n  },\r\n  validations(){\r\n    return {\r\n      amount: {required, minValue: minValue(0.01)},\r\n      description: {required},\r\n      category: {required},\r\n      type: {required}\r\n    }\r\n  },\r\n  async mounted() {\r\n    const temp = await this.$store.dispatch('fetchCategories')\r\n    temp.forEach(el => {\r\n      this.categories.push({\r\n        name: el.title,\r\n        value: el.id\r\n      })\r\n    })\r\n    this.loading = false\r\n  },\r\n  computed: {\r\n    canCreateRecord() {\r\n      const bill = this.$store.state.auth.userInfo.bill\r\n      if(this.type === \"outcome\"){\r\n        if(bill >= this.amount) return true\r\n        else return false\r\n      }\r\n      return true\r\n    }\r\n  },\r\n  methods: {\r\n    async handleForm() {\r\n      this.v$.$validate()\r\n      if(!this.v$.$errors.length){\r\n        if(this.canCreateRecord) { this.pushRecord() }\r\n        else alert(`Для совершения операции на вашем счету недостаточно средств - ${this.amount - this.$store.state.auth.userInfo.bill}`)\r\n      }\r\n    },\r\n    async pushRecord() {\r\n      const newRecord = {description: this.description, amount: this.amount,\r\n                         date: new Date().toJSON(), category: this.category, type: this.type}\r\n      const bill = newRecord.type === \"income\"\r\n        ? this.$store.state.auth.userInfo.bill += newRecord.amount\r\n        : this.$store.state.auth.userInfo.bill -= newRecord.amount\r\n      await this.$store.dispatch('pushRecord', newRecord)\r\n      await this.$store.dispatch('setUserBill', bill)\r\n\r\n      this.description = ''\r\n      this.amount = 1\r\n      this.v$.$reset()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" >\r\n  .page-title {\r\n    margin-top: 10px;\r\n  }\r\n  .record_form {\r\n    margin-top: 20px;\r\n    min-height: 400px;\r\n    max-width: 600px;\r\n    background-color: white;\r\n    border-radius: 8px;\r\n    border: 1px solid $light-gray;\r\n    box-shadow: 1px 10px 20px 1px $light-gray;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    gap: 30px;  \r\n    padding: 25px 20px;\r\n    .handle_category{\r\n      text-align: center;\r\n      width: 100%;\r\n      font-weight: bold;\r\n    }\r\n    .form_header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      border-bottom: 1px solid $light-gray;\r\n      padding-bottom: 20px;\r\n      .radio {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 15px;\r\n        .radio_input {\r\n          display: flex;\r\n          align-items: center;\r\n          & label { \r\n            margin-right: 10px;\r\n            cursor: pointer;\r\n          }\r\n          & input[type=\"radio\"] {\r\n            cursor: pointer;\r\n            border-radius: 50%;\r\n            border: 1px solid $light-gray;\r\n            height: 20px;\r\n            width: 20px;\r\n            appearance: none;\r\n            &:checked {\r\n              background-color: $accent-color;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .handler {\r\n    width: 100%;\r\n    height: calc(100vh - 150px);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n  .incorrect {\r\n    & > input {\r\n      border-color: $error-color\r\n    }\r\n  }\r\n</style>","import { render } from \"./RecordPage.vue?vue&type=template&id=624c4748\"\nimport script from \"./RecordPage.vue?vue&type=script&lang=js\"\nexport * from \"./RecordPage.vue?vue&type=script&lang=js\"\n\nimport \"./RecordPage.vue?vue&type=style&index=0&id=624c4748&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Desktop\\\\vue\\\\crm\\\\5\\\\crm-course\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","_createElementBlock","_hoisted_1","_hoisted_2","$data","_hoisted_14","_createVNode","_component_base_loader","onSubmit","$options","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","name","type","value","id","_hoisted_8","_hoisted_9","length","_hoisted_10","_component_base_select","options","_component_router_link","to","_component_base_input","number","placehldr","amount","$errors","description","_createBlock","_component_base_button","key","_hoisted_13","components","BaseButton","data","v$","useVuelidate","category","loading","categories","validations","required","minValue","async","temp","this","$store","dispatch","forEach","el","push","title","computed","canCreateRecord","bill","state","auth","userInfo","methods","$validate","pushRecord","alert","newRecord","date","Date","toJSON","$reset","__exports__","render"],"sourceRoot":""}